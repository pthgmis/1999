<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>陳情入口整合平台</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <style>
    /* 彈跳視窗（Modal）相關樣式 */
    .modal {
      display: none; /* 預設隱藏 */
      position: fixed; /* 固定在視窗上方 */
      z-index: 9999; /* 保證在最前方 */
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto; /* 內容若超出視窗，則產生捲軸 */
      background-color: rgba(0, 0, 0, 0.5); /* 半透明背景 */
    }
    .modal-content {
      background-color: #fff;
      margin: 10% auto; /* 使區塊在畫面置中 */
      padding: 2rem 2.5rem;
      width: 80%;
      max-width: 600px;
      position: relative;
      border-radius: 4px;
      max-height: 80vh; /* 避免 Modal 過高時超出畫面 */
      overflow-y: auto; /* 內容過多時可捲動 */
      white-space: normal; /* 預設就會換行 */
      /* 或者是 white-space: pre-wrap; */
      word-wrap: break-word; /* 長字自動換行 */
      border-right: 2px solid rgba(255, 0, 0, 0.1); /* 右邊框 */
      border-bottom: 2px solid rgba(255, 0, 0, 0.1); /* 下邊框 */
    }
    .modal-content h3 {
      margin-top: 0;
    }
    .close-button {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 24px;
      color: #333;
      cursor: pointer;
    }
    .close-button:hover {
      color: #666;
    }
  </style>
  <body>
    <!-- 頁首 -->
    <header>
      <h1>屏東縣政府陳情入口整合平台</h1>
      <nav>
        <ul>
          <li><a href="#">首頁</a></li>
          <!-- <li><a href="#">最新消息</a></li> -->
          <li><a href="chart.html">統計圖表</a></li>
          <li><a href="#">聯絡我們</a></li>
        </ul>
      </nav>
    </header>

    <!-- 按鈕查詢區 -->
    <section class="query-section">
      <div class="query-buttons">
        <button class="query-btn" onclick="location.href='case_query.html'">
          案件查詢
        </button>
        <button class="query-btn" onclick="location.href='mayor_mailbox.html'">
          縣長信箱
        </button>
        <!-- <button class="query-btn" onclick="location.href='faq.html'">常見問題集</button> -->
        <button class="query-btn" onclick="location.href='document_query.html'">
          公文查詢
        </button>

        <a
          href="https://www.pthg.gov.tw/e-service/"
          target="_blank"
          rel="noopener noreferrer"
          class="query-btn"
        >
          便民e櫃台
        </a>
        <!-- 更多服務按鈕 -->
        <div class="dropdown">
          <button class="query-btn">1999便民服務專線▼</button>
          <div class="dropdown-menu">
            <button
              class="dropdown-item"
              onclick="location.href='1999_service.html'"
            >
              1999服務時間與費率說明
            </button>
            <button
              class="dropdown-item"
              onclick="location.href='1999_case_process.html'"
            >
              案件流程與規範
            </button>
            <button class="dropdown-item" onclick="location.href='contact_info.html'">其他相關通報專線</button>
          </div>
        </div>
      </div>
    </section>

    <!-- 主要內容 -->
    <main>
      <section class="content">
        <h2>公告訊息</h2>
        <div id="news-container">
          <!-- 新聞內容將由 JavaScript 動態載入 -->
          <div class="loading">載入中...</div>
        </div>
      </section>
      <!-- 增加空白區域 -->
      <div class="spacer"></div>
    </main>

    <!-- 彈跳視窗 (Modal) 結構 -->
    <div id="modal" class="modal">
      <div class="modal-content">
        <!-- 關閉按鈕 -->
        <span id="close-modal" class="close-button">&times;</span>
        <!-- 這裡會動態載入新聞標題與內文 -->
        <h3 id="modal-title"></h3>
        <p id="modal-date" class="news-date"></p>
        <p id="modal-body" class="news-content"></p>
      </div>
    </div>

    <!-- 頁尾 -->
    <footer>
      <div class="footer-content">
        <p>屏東縣政府版權所有</p>
        <p>地址：900219 屏東縣屏東市自由路527號，電話：08-732-0415</p>

        <p>
          辦公時間：週一至週五
          08:00~12:00、13:00~17:00，彈性上下班時間：08:00-08:30 及 17:00-17:30
        </p>
        <p>
          1999便民服務專線（付費專線）：縣境內直撥 1999、外縣市請撥
          08-732-0415，服務時間每日 08:00~22:00
        </p>
        <a
          href="https://www.pthg.gov.tw/cp.aspx?n=12BA767FD998D05E"
          class="footer-link"
          >資安政策</a
        >
        <span>|</span>
        <a
          href="https://www.pthg.gov.tw/cp.aspx?n=48DF0A537FFF0FAF"
          class="footer-link"
          >隱私權政策</a
        >
        <span>|</span>
        <a
          href="https://www.pthg.gov.tw/cp.aspx?n=F0BADD3C2111A890"
          class="footer-link"
          >著作權聲明</a
        >
        <span>|</span>
        <a
          href="https://www.pthg.gov.tw/cp.aspx?n=71AA0F794E4D8D92"
          class="footer-link"
          >資料開放宣告</a
        >
      </div>
      <svg
        id="wave"
        style="transform: rotate(0deg); transition: 0.3s"
        viewBox="0 0 1440 490"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
      >
        <defs>
          <linearGradient id="sw-gradient-0" x1="0" x2="0" y1="1" y2="0">
            <stop stop-color="rgba(30, 205, 142, 1)" offset="0%"></stop>
            <stop stop-color="rgba(84, 179, 230, 1)" offset="100%"></stop>
          </linearGradient>
        </defs>
        <path
          style="transform: translate(0, 0px); opacity: 1"
          fill="url(#sw-gradient-0)"
          d="M0,147L60,171.5C120,196,240,245,360,253.2C480,261,600,229,720,253.2C840,278,960,359,1080,326.7C1200,294,1320,147,1440,147C1560,147,1680,294,1800,318.5C1920,343,2040,245,2160,171.5C2280,98,2400,49,2520,32.7C2640,16,2760,33,2880,89.8C3000,147,3120,245,3240,261.3C3360,278,3480,212,3600,196C3720,180,3840,212,3960,204.2C4080,196,4200,147,4320,106.2C4440,65,4560,33,4680,81.7C4800,131,4920,261,5040,326.7C5160,392,5280,392,5400,383.8C5520,376,5640,359,5760,318.5C5880,278,6000,212,6120,228.7C6240,245,6360,343,6480,375.7C6600,408,6720,376,6840,302.2C6960,229,7080,114,7200,89.8C7320,65,7440,131,7560,187.8C7680,245,7800,294,7920,326.7C8040,359,8160,376,8280,383.8C8400,392,8520,392,8580,392L8640,392L8640,490L8580,490C8520,490,8400,490,8280,490C8160,490,8040,490,7920,490C7800,490,7680,490,7560,490C7440,490,7320,490,7200,490C7080,490,6960,490,6840,490C6720,490,6600,490,6480,490C6360,490,6240,490,6120,490C6000,490,5880,490,5760,490C5640,490,5520,490,5400,490C5280,490,5160,490,5040,490C4920,490,4800,490,4680,490C4560,490,4440,490,4320,490C4200,490,4080,490,3960,490C3840,490,3720,490,3600,490C3480,490,3360,490,3240,490C3120,490,3000,490,2880,490C2760,490,2640,490,2520,490C2400,490,2280,490,2160,490C2040,490,1920,490,1800,490C1680,490,1560,490,1440,490C1320,490,1200,490,1080,490C960,490,840,490,720,490C600,490,480,490,360,490C240,490,120,490,60,490L0,490Z"
        ></path>
      </svg>
    </footer>

    <script>
      // 載入最新訊息並綁定點擊事件
      async function loadNews() {
        try {
          const response = await fetch("news.json");
          const data = await response.json();
          data.news.sort((a, b) => a.id - b.id); // 依id排序
          const newsContainer = document.getElementById("news-container");

          // 清空「載入中...」訊息
          newsContainer.innerHTML = "";

          // 逐筆建立新聞項目
          data.news.forEach((item) => {
            const newsItem = document.createElement("div");
            newsItem.className = `news-item ${
              item.important ? "important" : ""
            }`;
            // 塞入簡要資訊
            newsItem.innerHTML = `
              <h3>${item.title}</h3>
              <p class="news-date">發布日期：${item.date}</p>
              <p class="news-content">
                <!-- 為了版面美觀，可只顯示前幾行或前幾個字，此處示範保留部分內容 -->
                ${item.content.substring(0, 30)}... 
              </p>
            `;

            // 點擊後顯示彈跳視窗的完整內容
            newsItem.addEventListener("click", () => {
              // 取得 Modal 相關元素
              const modal = document.getElementById("modal");
              const modalTitle = document.getElementById("modal-title");
              const modalDate = document.getElementById("modal-date");
              const modalBody = document.getElementById("modal-body");

              // 動態填入內容
              modalTitle.textContent = item.title;
              modalDate.textContent = "發布日期：" + item.date;
              modalBody.textContent = item.content;

              // 顯示 Modal
              modal.style.display = "block";
            });

            newsContainer.appendChild(newsItem);
          });
        } catch (error) {
          console.error("載入新聞資料時發生錯誤:", error);
          document.getElementById("news-container").innerHTML =
            '<p class="error">載入資料時發生錯誤，請稍後再試。</p>';
        }
      }

      // 註冊關閉 Modal 的事件
      function initModalClose() {
        const modal = document.getElementById("modal");
        const closeModalBtn = document.getElementById("close-modal");

        // 點擊「X」關閉
        closeModalBtn.addEventListener("click", () => {
          modal.style.display = "none";
        });

        // 點擊背景區域也關閉
        window.addEventListener("click", (event) => {
          if (event.target === modal) {
            modal.style.display = "none";
          }
        });
      }

      // 當頁面載入完成時執行
      document.addEventListener("DOMContentLoaded", () => {
        loadNews();
        initModalClose();
      });
    </script>
  </body>
</html>
